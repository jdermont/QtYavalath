#ifndef BOARD_H
#define BOARD_H

#include <stdint.h>
#include <vector>
#include <string>

#define PLAYER_NONE 0
#define PLAYER_ONE 1
#define intWO 2

using namespace std;

// bitboard generation and idea taken from https://github.com/skeeto/yavalath
static const vector<vector<uint64_t>> pattern_lose = {
    {
        0x00002041L, 0x00000007L, 0x00000821L,
    },
    {
        0x00004082L, 0x00000007L, 0x0000000eL,
        0x00001042L,
    },
    {
        0x00008104L, 0x00000007L, 0x0000000eL,
        0x0000001cL, 0x00002084L,
    },
    {
        0x00010208L, 0x0000000eL, 0x0000001cL,
        0x00004108L,
    },
    {
        0x00020410L, 0x0000001cL, 0x00008210L,
    },
    {
        0x00101020L, 0x000000e0L, 0x00040820L,
        0x00000821L,
    },
    {
        0x00002041L, 0x00202040L, 0x000000e0L,
        0x000001c0L, 0x00081040L, 0x00001042L,
    },
    {
        0x00004082L, 0x00404080L, 0x000000e0L,
        0x000001c0L, 0x00000380L, 0x00102080L,
        0x00002084L,
    },
    {
        0x00008104L, 0x00808100L, 0x000001c0L,
        0x00000380L, 0x00000700L, 0x00204100L,
        0x00004108L,
    },
    {
        0x00010208L, 0x01010200L, 0x00000380L,
        0x00000700L, 0x00408200L, 0x00008210L,
    },
    {
        0x00020410L, 0x02020400L, 0x00000700L,
        0x00810400L,
    },
    {
        0x10080800L, 0x00003800L, 0x04040800L,
        0x00040820L, 0x00000821L,
    },
    {
        0x00101020L, 0x20101000L, 0x00003800L,
        0x00007000L, 0x08081000L, 0x00081040L,
        0x00001042L,
    },
    {
        0x00002041L, 0x00202040L, 0x40202000L,
        0x00003800L, 0x00007000L, 0x0000e000L,
        0x10102000L, 0x00102080L, 0x00002084L,
    },
    {
        0x00004082L, 0x00404080L, 0x80404000L,
        0x00007000L, 0x0000e000L, 0x0001c000L,
        0x20204000L, 0x00204100L, 0x00004108L,
    },
    {
        0x00008104L, 0x00808100L, 0x0000000100808000L,
        0x0000e000L, 0x0001c000L, 0x00038000L,
        0x40408000L, 0x00408200L, 0x00008210L,
    },
    {
        0x00010208L, 0x01010200L, 0x0000000201010000L,
        0x0001c000L, 0x00038000L, 0x80810000L,
        0x00810400L,
    },
    {
        0x00020410L, 0x02020400L, 0x0000000402020000L,
        0x00038000L, 0x0000000101020000L,
    },
    {
        0x0000001008040000L, 0x001c0000L, 0x04040800L,
        0x00040820L,
    },
    {
        0x10080800L, 0x0000002010080000L, 0x001c0000L,
        0x00380000L, 0x0000000808080000L, 0x08081000L,
        0x00081040L,
    },
    {
        0x00101020L, 0x20101000L, 0x0000004020100000L,
        0x001c0000L, 0x00380000L, 0x00700000L,
        0x0000001010100000L, 0x10102000L, 0x00102080L,
    },
    {
        0x00202040L, 0x40202000L, 0x0000008040200000L,
        0x00380000L, 0x00700000L, 0x00e00000L,
        0x0000002020200000L, 0x20204000L, 0x00204100L,
    },
    {
        0x00404080L, 0x80404000L, 0x0000010080400000L,
        0x00700000L, 0x00e00000L, 0x01c00000L,
        0x0000004040400000L, 0x40408000L, 0x00408200L,
    },
    {
        0x00808100L, 0x0000000100808000L, 0x0000020100800000L,
        0x00e00000L, 0x01c00000L, 0x03800000L,
        0x0000008080800000L, 0x80810000L, 0x00810400L,
    },
    {
        0x01010200L, 0x0000000201010000L, 0x0000040201000000L,
        0x01c00000L, 0x03800000L, 0x0000010101000000L,
        0x0000000101020000L,
    },
    {
        0x02020400L, 0x0000000402020000L, 0x03800000L,
        0x0000020202000000L,
    },
    {
        0x0000080804000000L, 0x1c000000L, 0x04040800L,
    },
    {
        0x0000001008040000L, 0x0000101008000000L, 0x1c000000L,
        0x38000000L, 0x0000000808080000L, 0x08081000L,
    },
    {
        0x10080800L, 0x0000002010080000L, 0x0000202010000000L,
        0x1c000000L, 0x38000000L, 0x70000000L,
        0x0000081010000000L, 0x0000001010100000L, 0x10102000L,
    },
    {
        0x20101000L, 0x0000004020100000L, 0x0000404020000000L,
        0x38000000L, 0x70000000L, 0xe0000000L,
        0x0000102020000000L, 0x0000002020200000L, 0x20204000L,
    },
    {
        0x40202000L, 0x0000008040200000L, 0x0000808040000000L,
        0x70000000L, 0xe0000000L, 0x00000001c0000000L,
        0x0000204040000000L, 0x0000004040400000L, 0x40408000L,
    },
    {
        0x80404000L, 0x0000010080400000L, 0x0001010080000000L,
        0xe0000000L, 0x00000001c0000000L, 0x0000000380000000L,
        0x0000408080000000L, 0x0000008080800000L, 0x80810000L,
    },
    {
        0x0000000100808000L, 0x0000020100800000L, 0x0002020100000000L,
        0x00000001c0000000L, 0x0000000380000000L, 0x0000000700000000L,
        0x0000810100000000L, 0x0000010101000000L, 0x0000000101020000L,
    },
    {
        0x0000000201010000L, 0x0000040201000000L, 0x0000000380000000L,
        0x0000000700000000L, 0x0001020200000000L, 0x0000020202000000L,
    },
    {
        0x0000000402020000L, 0x0000000700000000L, 0x0002040400000000L,
    },
    {
        0x0000080804000000L, 0x0004080800000000L, 0x0000003800000000L,
        0x0000000808080000L,
    },
    {
        0x0000001008040000L, 0x0000101008000000L, 0x0008101000000000L,
        0x0000003800000000L, 0x0000007000000000L, 0x0000081010000000L,
        0x0000001010100000L,
    },
    {
        0x0000002010080000L, 0x0000202010000000L, 0x0010202000000000L,
        0x0000003800000000L, 0x0000007000000000L, 0x000000e000000000L,
        0x0004102000000000L, 0x0000102020000000L, 0x0000002020200000L,
    },
    {
        0x0000004020100000L, 0x0000404020000000L, 0x0020404000000000L,
        0x0000007000000000L, 0x000000e000000000L, 0x000001c000000000L,
        0x0008204000000000L, 0x0000204040000000L, 0x0000004040400000L,
    },
    {
        0x0000008040200000L, 0x0000808040000000L, 0x0040808000000000L,
        0x000000e000000000L, 0x000001c000000000L, 0x0000038000000000L,
        0x0010408000000000L, 0x0000408080000000L, 0x0000008080800000L,
    },
    {
        0x0000010080400000L, 0x0001010080000000L, 0x0081010000000000L,
        0x000001c000000000L, 0x0000038000000000L, 0x0000070000000000L,
        0x0020810000000000L, 0x0000810100000000L, 0x0000010101000000L,
    },
    {
        0x0000020100800000L, 0x0002020100000000L, 0x0000038000000000L,
        0x0000070000000000L, 0x0041020000000000L, 0x0001020200000000L,
        0x0000020202000000L,
    },
    {
        0x0000040201000000L, 0x0000070000000000L, 0x0082040000000000L,
        0x0002040400000000L,
    },
    {
        0x0000080804000000L, 0x0004080800000000L, 0x0104080000000000L,
        0x0000380000000000L, 0x0000081010000000L,

    },
    {
        0x0000101008000000L, 0x0008101000000000L, 0x0208100000000000L,
        0x0000380000000000L, 0x0000700000000000L, 0x0004102000000000L,
        0x0000102020000000L,
    },
    {
        0x0000202010000000L, 0x0010202000000000L, 0x0410200000000000L,
        0x0000380000000000L, 0x0000700000000000L, 0x0000e00000000000L,
        0x0108200000000000L, 0x0008204000000000L, 0x0000204040000000L,
    },
    {
        0x0000404020000000L, 0x0020404000000000L, 0x0820400000000000L,
        0x0000700000000000L, 0x0000e00000000000L, 0x0001c00000000000L,
        0x0210400000000000L, 0x0010408000000000L, 0x0000408080000000L,
    },
    {
        0x0000808040000000L, 0x0040808000000000L, 0x1040800000000000L,
        0x0000e00000000000L, 0x0001c00000000000L, 0x0003800000000000L,
        0x0420800000000000L, 0x0020810000000000L, 0x0000810100000000L,
    },
    {
        0x0001010080000000L, 0x0081010000000000L, 0x0001c00000000000L,
        0x0003800000000000L, 0x0841000000000000L, 0x0041020000000000L,
        0x0001020200000000L,
    },
    {
        0x0002020100000000L, 0x0003800000000000L, 0x1082000000000000L,
        0x0082040000000000L, 0x0002040400000000L,
    },
    {
        0x0004080800000000L, 0x0104080000000000L, 0x001c000000000000L,
        0x0004102000000000L,
    },
    {
        0x0008101000000000L, 0x0208100000000000L, 0x001c000000000000L,
        0x0038000000000000L, 0x0108200000000000L, 0x0008204000000000L,
    },
    {
        0x0010202000000000L, 0x0410200000000000L, 0x001c000000000000L,
        0x0038000000000000L, 0x0070000000000000L, 0x0210400000000000L,
        0x0010408000000000L,
    },
    {
        0x0020404000000000L, 0x0820400000000000L, 0x0038000000000000L,
        0x0070000000000000L, 0x00e0000000000000L, 0x0420800000000000L,
        0x0020810000000000L,
    },
    {
        0x0040808000000000L, 0x1040800000000000L, 0x0070000000000000L,
        0x00e0000000000000L, 0x0841000000000000L, 0x0041020000000000L,
    },
    {
        0x0081010000000000L, 0x00e0000000000000L, 0x1082000000000000L,
        0x0082040000000000L,
    },
    {
        0x0104080000000000L, 0x0700000000000000L, 0x0108200000000000L,
    },
    {
        0x0208100000000000L, 0x0700000000000000L, 0x0e00000000000000L,
        0x0210400000000000L,
    },
    {
        0x0410200000000000L, 0x0700000000000000L, 0x0e00000000000000L,
        0x1c00000000000000L, 0x0420800000000000L,
    },
    {
        0x0820400000000000L, 0x0e00000000000000L, 0x1c00000000000000L,
        0x0841000000000000L,
    },
    {
        0x1040800000000000L, 0x1c00000000000000L, 0x1082000000000000L,
    },
};

static const vector<vector<uint64_t>> pattern_win = {
    {
        0x00202041L, 0x0000000fL, 0x00040821L,

    },
    {
        0x00404082L, 0x0000000fL, 0x0000001eL,
        0x00081042L,
    },
    {
        0x00808104L, 0x0000000fL, 0x0000001eL,
        0x00102084L,
    },
    {
        0x01010208L, 0x0000000fL, 0x0000001eL,
        0x00204108L,
    },
    {
        0x02020410L, 0x0000001eL, 0x00408210L,
    },
    {
        0x20101020L, 0x000001e0L, 0x04040820L,
        0x00040821L,
    },
    {
        0x00202041L, 0x40202040L, 0x000001e0L,
        0x000003c0L, 0x08081040L, 0x00081042L,
    },
    {
        0x00404082L, 0x80404080L, 0x000001e0L,
        0x000003c0L, 0x00000780L, 0x10102080L,
        0x00102084L,
    },
    {
        0x00808104L, 0x0000000100808100L, 0x000001e0L,
        0x000003c0L, 0x00000780L, 0x20204100L,
        0x00204108L,
    },
    {
        0x01010208L, 0x0000000201010200L, 0x000003c0L,
        0x00000780L, 0x40408200L, 0x00408210L,
    },
    {
        0x02020410L, 0x0000000402020400L, 0x00000780L,
        0x80810400L,
    },
    {
        0x0000002010080800L, 0x00007800L, 0x04040820L,
        0x00040821L,
    },
    {
        0x20101020L, 0x0000004020101000L, 0x00007800L,
        0x0000f000L, 0x0000000808081000L, 0x08081040L,
        0x00081042L,
    },
    {
        0x00202041L, 0x40202040L, 0x0000008040202000L,
        0x00007800L, 0x0000f000L, 0x0001e000L,
        0x0000001010102000L, 0x10102080L, 0x00102084L,
    },
    {
        0x00404082L, 0x80404080L, 0x0000010080404000L,
        0x00007800L, 0x0000f000L, 0x0001e000L,
        0x0003c000L, 0x0000002020204000L, 0x20204100L,
        0x00204108L,
    },
    {
        0x00808104L, 0x0000000100808100L, 0x0000020100808000L,
        0x0000f000L, 0x0001e000L, 0x0003c000L,
        0x0000004040408000L, 0x40408200L, 0x00408210L,
    },
    {
        0x01010208L, 0x0000000201010200L, 0x0000040201010000L,
        0x0001e000L, 0x0003c000L, 0x0000008080810000L,
        0x80810400L,
    },
    {
        0x02020410L, 0x0000000402020400L, 0x0003c000L,
        0x0000010101020000L,
    },
    {
        0x0000101008040000L, 0x003c0000L, 0x04040820L,
        0x00040821L,
    },
    {
        0x0000002010080800L, 0x0000202010080000L, 0x003c0000L,
        0x00780000L, 0x0000000808081000L, 0x08081040L,
        0x00081042L,
    },
    {
        0x20101020L, 0x0000004020101000L, 0x0000404020100000L,
        0x003c0000L, 0x00780000L, 0x00f00000L,
        0x0000081010100000L, 0x0000001010102000L, 0x10102080L,
        0x00102084L,
    },
    {
        0x00202041L, 0x40202040L, 0x0000008040202000L,
        0x0000808040200000L, 0x003c0000L, 0x00780000L,
        0x00f00000L, 0x01e00000L, 0x0000102020200000L,
        0x0000002020204000L, 0x20204100L, 0x00204108L,
    },
    {
        0x00404082L, 0x80404080L, 0x0000010080404000L,
        0x0001010080400000L, 0x00780000L, 0x00f00000L,
        0x01e00000L, 0x03c00000L, 0x0000204040400000L,
        0x0000004040408000L, 0x40408200L, 0x00408210L,
    },
    {
        0x00808104L, 0x0000000100808100L, 0x0000020100808000L,
        0x0002020100800000L, 0x00f00000L, 0x01e00000L,
        0x03c00000L, 0x0000408080800000L, 0x0000008080810000L,
        0x80810400L,
    },
    {
        0x01010208L, 0x0000000201010200L, 0x0000040201010000L,
        0x01e00000L, 0x03c00000L, 0x0000810101000000L,
        0x0000010101020000L,
    },
    {
        0x02020410L, 0x0000000402020400L, 0x03c00000L,
        0x0001020202000000L,
    },
    {
        0x0004080804000000L, 0x3c000000L, 0x04040820L,
    },
    {
        0x0000101008040000L, 0x0008101008000000L, 0x3c000000L,
        0x78000000L, 0x0000000808081000L, 0x08081040L,
    },
    {
        0x0000002010080800L, 0x0000202010080000L, 0x0010202010000000L,
        0x3c000000L, 0x78000000L, 0xf0000000L,
        0x0000081010100000L, 0x0000001010102000L, 0x10102080L,
    },
    {
        0x20101020L, 0x0000004020101000L, 0x0000404020100000L,
        0x0020404020000000L, 0x3c000000L, 0x78000000L,
        0xf0000000L, 0x00000001e0000000L, 0x0004102020000000L,
        0x0000102020200000L, 0x0000002020204000L, 0x20204100L,
    },
    {
        0x40202040L, 0x0000008040202000L, 0x0000808040200000L,
        0x0040808040000000L, 0x78000000L, 0xf0000000L,
        0x00000001e0000000L, 0x00000003c0000000L, 0x0008204040000000L,
        0x0000204040400000L, 0x0000004040408000L, 0x40408200L,
    },
    {
        0x80404080L, 0x0000010080404000L, 0x0001010080400000L,
        0x0081010080000000L, 0xf0000000L, 0x00000001e0000000L,
        0x00000003c0000000L, 0x0000000780000000L, 0x0010408080000000L,
        0x0000408080800000L, 0x0000008080810000L, 0x80810400L,
    },
    {
        0x0000000100808100L, 0x0000020100808000L, 0x0002020100800000L,
        0x00000001e0000000L, 0x00000003c0000000L, 0x0000000780000000L,
        0x0020810100000000L, 0x0000810101000000L, 0x0000010101020000L,
    },
    {
        0x0000000201010200L, 0x0000040201010000L, 0x00000003c0000000L,
        0x0000000780000000L, 0x0041020200000000L, 0x0001020202000000L,
    },
    {
        0x0000000402020400L, 0x0000000780000000L, 0x0082040400000000L,
    },
    {
        0x0004080804000000L, 0x0104080800000000L, 0x0000007800000000L,
        0x0000000808081000L,
    },
    {
        0x0000101008040000L, 0x0008101008000000L, 0x0208101000000000L,
        0x0000007800000000L, 0x000000f000000000L, 0x0000081010100000L,
        0x0000001010102000L,
    },
    {
        0x0000002010080800L, 0x0000202010080000L, 0x0010202010000000L,
        0x0410202000000000L, 0x0000007800000000L, 0x000000f000000000L,
        0x000001e000000000L, 0x0004102020000000L, 0x0000102020200000L,
        0x0000002020204000L,
    },
    {
        0x0000004020101000L, 0x0000404020100000L, 0x0020404020000000L,
        0x0820404000000000L, 0x0000007800000000L, 0x000000f000000000L,
        0x000001e000000000L, 0x000003c000000000L, 0x0108204000000000L,
        0x0008204040000000L, 0x0000204040400000L, 0x0000004040408000L,
    },
    {
        0x0000008040202000L, 0x0000808040200000L, 0x0040808040000000L,
        0x1040808000000000L, 0x000000f000000000L, 0x000001e000000000L,
        0x000003c000000000L, 0x0000078000000000L, 0x0210408000000000L,
        0x0010408080000000L, 0x0000408080800000L, 0x0000008080810000L,
    },
    {
        0x0000010080404000L, 0x0001010080400000L, 0x0081010080000000L,
        0x000001e000000000L, 0x000003c000000000L, 0x0000078000000000L,
        0x0420810000000000L, 0x0020810100000000L, 0x0000810101000000L,
        0x0000010101020000L,
    },
    {
        0x0000020100808000L, 0x0002020100800000L, 0x000003c000000000L,
        0x0000078000000000L, 0x0841020000000000L, 0x0041020200000000L,
        0x0001020202000000L,
    },
    {
        0x0000040201010000L, 0x0000078000000000L, 0x1082040000000000L,
        0x0082040400000000L,
    },
    {
        0x0004080804000000L, 0x0104080800000000L, 0x0000780000000000L,
        0x0000081010100000L,
    },
    {
        0x0000101008040000L, 0x0008101008000000L, 0x0208101000000000L,
        0x0000780000000000L, 0x0000f00000000000L, 0x0004102020000000L,
        0x0000102020200000L,
    },
    {
        0x0000202010080000L, 0x0010202010000000L, 0x0410202000000000L,
        0x0000780000000000L, 0x0000f00000000000L, 0x0001e00000000000L,
        0x0108204000000000L, 0x0008204040000000L, 0x0000204040400000L,
    },
    {
        0x0000404020100000L, 0x0020404020000000L, 0x0820404000000000L,
        0x0000780000000000L, 0x0000f00000000000L, 0x0001e00000000000L,
        0x0003c00000000000L, 0x0210408000000000L, 0x0010408080000000L,
        0x0000408080800000L,
    },
    {
        0x0000808040200000L, 0x0040808040000000L, 0x1040808000000000L,
        0x0000f00000000000L, 0x0001e00000000000L, 0x0003c00000000000L,
        0x0420810000000000L, 0x0020810100000000L, 0x0000810101000000L,

    },
    {
        0x0001010080400000L, 0x0081010080000000L, 0x0001e00000000000L,
        0x0003c00000000000L, 0x0841020000000000L, 0x0041020200000000L,
        0x0001020202000000L,
    },
    {
        0x0002020100800000L, 0x0003c00000000000L, 0x1082040000000000L,
        0x0082040400000000L,
    },
    {
        0x0004080804000000L, 0x0104080800000000L, 0x003c000000000000L,
        0x0004102020000000L,
    },
    {
        0x0008101008000000L, 0x0208101000000000L, 0x003c000000000000L,
        0x0078000000000000L, 0x0108204000000000L, 0x0008204040000000L,
    },
    {
        0x0010202010000000L, 0x0410202000000000L, 0x003c000000000000L,
        0x0078000000000000L, 0x00f0000000000000L, 0x0210408000000000L,
        0x0010408080000000L,
    },
    {
        0x0020404020000000L, 0x0820404000000000L, 0x003c000000000000L,
        0x0078000000000000L, 0x00f0000000000000L, 0x0420810000000000L,
        0x0020810100000000L,
    },
    {
        0x0040808040000000L, 0x1040808000000000L, 0x0078000000000000L,
        0x00f0000000000000L, 0x0841020000000000L, 0x0041020200000000L,
    },
    {
        0x0081010080000000L, 0x00f0000000000000L, 0x1082040000000000L,
        0x0082040400000000L,
    },
    {
        0x0104080800000000L, 0x0f00000000000000L, 0x0108204000000000L,
    },
    {
        0x0208101000000000L, 0x0f00000000000000L, 0x1e00000000000000L,
        0x0210408000000000L,
    },
    {
        0x0410202000000000L, 0x0f00000000000000L, 0x1e00000000000000L,
        0x0420810000000000L,
    },
    {
        0x0820404000000000L, 0x0f00000000000000L, 0x1e00000000000000L,
        0x0841020000000000L,
    },
    {
        0x1040808000000000L, 0x1e00000000000000L, 0x1082040000000000L,
    },
};

class Board
{
public:
    Board();
    vector<int> getAvailableMoves();
    void makeMove(int player, int move);
    void undoMove(int player, int move);
    bool isFilled(int move);
    void setBoard(Board board);
    bool isOver(int player, int move);
    int getWinner(int player, int move);
    string getState();

private:
    uint64_t oneBoard, twoBoard;

    bool isWinner(int player, int move);
    bool isLoser(int player, int move);
};

#endif // BOARD_H
